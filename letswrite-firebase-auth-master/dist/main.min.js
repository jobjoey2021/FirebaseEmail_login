"use strict";document.addEventListener("DOMContentLoaded",(function(){var e=document.getElementById("type"),t=document.querySelectorAll(".tab-title a");function n(){var t=document.getElementById("email").value,n=document.getElementById("password").value;"signin"===e.value?function(e,t){firebase.auth().signInWithEmailAndPassword(e,t).then((function(){document.querySelector(".user-null").classList.add("none")})).catch((function(e){c(e.message)}))}(t,n):"create"===e.value&&function(e,t){firebase.auth().createUserWithEmailAndPassword(e,t).then((function(){document.querySelector(".user-null").classList.add("none")})).catch((function(e){c(e.message)}))}(t,n)}Array.prototype.forEach.call(t,(function(t){t.addEventListener("click",(function(t){t.preventDefault(),document.querySelector(".tab-title .active").classList.remove("active"),t.target.classList.add("active"),e.value=t.target.dataset.value}))}));var o=document.getElementById("error-message");function c(e){o.innerHTML=e}function a(e){return new Promise((function(t,n){var o=firebase.auth().currentUser,c=document.getElementById(e).value,a=firebase.auth.EmailAuthProvider.credential(o.email,c);o.reauthenticateWithCredential(a).then((function(){t(o)})).catch((function(e){n(e.message)}))}))}document.getElementById("sign-up").addEventListener("click",n),document.getElementById("password").addEventListener("keyup",(function(e){"Enter"!==e.code&&"NumpadEnter"!==e.code||n()})),firebase.auth().onAuthStateChanged((function(e){if(e){console.log("user",e),document.querySelector(".user-logged").classList.remove("none"),c("");var t=e.displayName,n=e.email,o=e.uid,d=e.emailVerified;t&&(document.getElementById("user-name").innerHTML="您的名稱：".concat(t)),document.getElementById("user-email").innerHTML="您的帳號：".concat(n),document.getElementById("user-uid").innerHTML="您的Uid：".concat(o),document.getElementById("user-email-verify").innerHTML="您的信箱是否驗證：".concat(d),document.getElementById("editor").addEventListener("click",(function(e){document.querySelector(".user-logged").classList.add("none"),document.querySelector(".user-editor").classList.remove("none")})),document.getElementById("sure-name").addEventListener("click",(function(t){!function(t){e.updateProfile({displayName:t}).then((function(){window.location.reload()})).catch((function(e){c(e.message)}))}(document.getElementById("new-name").value)})),document.getElementById("changePassword").addEventListener("click",(function(e){document.querySelector(".user-logged").classList.add("none"),document.querySelector(".user-password").classList.remove("none")})),document.getElementById("sure-password").addEventListener("click",(function(){var e;document.getElementById("new-password").value;e=document.getElementById("new-password").value,a("old-password-change").then((function(t){t.updatePassword(e).then((function(){window.alert("密碼更新完成，請重新登入"),firebase.auth().signOut().then((function(){window.location.reload()}))})).catch((function(e){c(e.message)}))})).catch((function(e){c(e.message)}))})),document.getElementById("verify-email").addEventListener("click",(function(){e.sendEmailVerification().then((function(){window.alert("驗證信已發送到您的信箱，請查收。")})).catch((function(e){c(e.message)}))})),document.getElementById("logout").addEventListener("click",(function(){firebase.auth().signOut().then((function(){window.location.reload()})).catch((function(e){c(e.message)}))})),document.getElementById("delete-user").addEventListener("click",(function(e){document.querySelector(".user-logged").classList.add("none"),document.querySelector(".user-delete").classList.remove("none")})),document.getElementById("sure-delete").addEventListener("click",(function(){a("old-password-delete").then((function(e){e.delete().then((function(){window.alert("您的帳號已成功刪除"),window.location.reload()})).catch((function(e){c(e.message)}))})).catch((function(e){c(e.message)}))}))}else{document.querySelector(".user-null").classList.remove("none"),c(""),document.getElementById("forgot").addEventListener("click",(function(e){e.preventDefault(),document.querySelector(".user-null").classList.add("none"),document.querySelector(".user-forgot").classList.remove("none")})),document.getElementById("sure-forgot").addEventListener("click",(function(e){var t=document.getElementById("new-forgot").value,n=firebase.auth();firebase.auth().languageCode="zh-TW",n.sendPasswordResetEmail(t).then((function(){window.alert("已發送信件至信箱，請按照信件說明重設密碼"),window.location.reload()})).catch((function(e){c(e.message)}))}))}}))}));